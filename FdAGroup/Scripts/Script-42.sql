


SELECT * FROM SMEDATBND.BRENTI0F WHERE E§TRAG='PVE' 
AND E



SELECT * FROM SMEDATFDA.C£CONR0F WHERE C£NUMP='X30' 


CREATE TABLE CED.PVEMOD (CDPVE CHAR(15))

INSERT INTO CED.PVEMOD  SELECT SUBSTR(F1, 2, 7) FROM CED.CDPV 

SELECT * FROM CED.PVEMOD



SELECT * FROM CED.BRENTIMOD 

DELETE FROM CED.BRENTIMOD 
WHERE -- E§TRAG<>'PVE'  
E§CRAG NOT IN (SELECT CDPVE FROM  CED.PVEMOD) 

INSERT INTO CED.BRENTIBAK 
SELECT * FROM SMEDATBND.BRENTI0F WHERE E§TRAG='PVE' 
AND E§CRAG IN (SELECT CDPVE FROM CED.PVEMOD) 
AND E§DINV <= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)
       AND E§DFNV >= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE) 
                     

UPDATE SMEDATBND.BRENTI0F A 
SET A.E§INDA = (SELECT B.E§INDA FROM CED.BRENTIMOD B WHERE B.E§CRAG=A.E§CRAG 
AND B.E§DINV <= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)
       AND B.E§DFNV >= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE) ) 
WHERE A.E§TRAG='PVE' 
AND A.E§CRAG IN (SELECT X.E§CRAG FROM CED.BRENTIMOD X) 


AND E§DINV <= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)
       AND E§DFNV >= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE) 
                     
                     
                                       
SELECT * FROM SMEDATBND.BRENTI0F 
WHERE E§TRAG='PVE' AND LENGTH(TRIM(E§CRAG)) >7 
AND E§DINV <= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)
       AND E§DFNV >= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)    
                     
                     
SELECT max(substr(e§crag, 1, 7))  FROM smedatbnd.brenti0f 
WHERE e§trag='PVE' 

SELECT * FROM smedatbnd.brenti0f WHERE e§trag='PVE'  
AND substr(e§crag, 1, 7) >'2000000'



SELECT max(substr(e§crag, 1, 6)) FROM smedatbnd.brenti0f WHERE e§trag='CLI'   


SELECT E§CRAG, COUNT(E§CRAG) FROM SMEDATBND.BRENTI0F 
WHERE E§TRAG='PVE'  
GROUP BY  E§CRAG HAVING COUNT E§CRAG >1
AND E§DINV <= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)
       AND E§DFNV >= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)
                     
                     
                     
GROUP BY  E§CRAG HAVING COUNT E§CRAG >1

                     
SELECT * FROM SMEDATBND.BRENTI0F WHERE E§TRAG='PVE' 
AND LEFT(E§CRAG, 7) BETWEEN  '0229018' AND '0220400' 

SELECT * FROM CED.BRENTIWK  



SELECT 

 

SELECT SUBSTR(DIGITS(229017 + RRN(A)), 10, 7) AS NEWCD, E§CRAG, E§TRAG FROM CED.BRENTIWK A -- 

UPDATE CED.BRENTIWK A 
SET E§CRAG= SUBSTR(DIGITS(229017 + RRN(A)), 10, 7)

WHERE E§IDOJ IN 

INSERT INTO CED.BRENTIWK SELECT * FROM SMEDATBND.BRENTI0F WHERE E§IDOJ IN 

INSERT INTO SMEDATBND.BRENTI0F SELECT * FROM CED.BRENTIWK 

DELETE FROM SMEDATBND.BRENTI0F WHERE E§IDOJ IN 


UPDATE CED.BRENTIWK A 
SET A.E§SCEN=( SELECT B.E§CRAG FROM SMETSTBND.BRENTI0F B WHERE B.E§IDOJ=A.E§IDOJ)

SELECT *  FROM SMETSTBND.BRENTI0F WHERE E§IDOJ IN 
(
'0036067347', 
'0036067509', 
'0036067586', 
'0036067602', 
'0035868618', 
'0036039210', 
'0036039218', 
'0036039220', 
'0036039224', 
'0036039226', 
'0036039228', 
'0036039230', 
'0036039232', 
'0036039234', 
'0036039236', 
'0036039238', 
'0036039240', 
'0036039242', 
'0036039244', 
'0036039246', 
'0036039248', 
'0036039250', 
'0036039252', 
'0036039254', 
'0036039256', 
'0036039258', 
'0036039260', 
'0036039262', 
'0036039264', 
'0036039266', 
'0036039268', 
'0036039270', 
'0036039272', 
'0036039274', 
'0036039276', 
'0036039278', 
'0036039280', 
'0036039282', 
'0036039284', 
'0036039286', 
'0036039288', 
'0036039290', 
'0036039292', 
'0036039294', 
'0036039296', 
'0036039298', 
'0036039300', 
'0036039302', 
'0036039304', 
'0036039306', 
'0036039308', 
'0036039310', 
'0036039312', 
'0036039314', 
'0036039316', 
'0036039318', 
'0036039320', 
'0036039322', 
'0036039324', 
'0036039326', 
'0036039328', 
'0036039330', 
'0036039332', 
'0036039334', 
'0036039336', 
'0036039338', 
'0036039340', 
'0036039342', 
'0036039344', 
'0036039346', 
'0036039348', 
'0036039350', 
'0036039352', 
'0036039356', 
'0036039358', 
'0036039360', 
'0036039362', 
'0036039368', 
'0036039386', 
'0036039388', 
'0036039390', 
'0036039392', 
'0036039394', 
'0036039396', 
'0036039398', 
'0036039400', 
'0036039402', 
'0036039404', 
'0036039406', 
'0036039408', 
'0036039410', 
'0036039412', 
'0036039414', 
'0036039416', 
'0036039418', 
'0036039420', 
'0036039422', 
'0036039424', 
'0036039426', 
'0036039428', 
'0036039430', 
'0036039432', 
'0036039434', 
'0036039436', 
'0036039438', 
'0036039440', 
'0036039442', 
'0036039444', 
'0036039446', 
'0036039448', 
'0036039450', 
'0036039452', 
'0036039454', 
'0036039456', 
'0036039458', 
'0036039460', 
'0036039462', 
'0036039464', 
'0036039466', 
'0036039468', 
'0036039470', 
'0036039472', 
'0036039474', 
'0036039478', 
'0036039480', 
'0036039482', 
'0036039486', 
'0036039488', 
'0036039490', 
'0036039492', 
'0036039494', 
'0036039496', 
'0036039498', 
'0036039500', 
'0036039502', 
'0036039504', 
'0036039506', 
'0036039508', 
'0036039510', 
'0036039512', 
'0036039514', 
'0036039516', 
'0036039520', 
'0036039522', 
'0036039524', 
'0036039526', 
'0036039528', 
'0036039532', 
'0036039534', 
'0036039536', 
'0036039538', 
'0036039540', 
'0036039542', 
'0036039600', 
'0036039602', 
'0036039604', 
'0036039622', 
'0036039676', 
'0036039682', 
'0036039684', 
'0036039686', 
'0036039710', 
'0036039730', 
'0036039736', 
'0036039822', 
'0036039824', 
'0036039826', 
'0036039848', 
'0036039904', 
'0036039906', 
'0036039908', 
'0036039910', 
'0036040174', 
'0036040288', 
'0036040294', 
'0036040472', 
'0036040474', 
'0036040476', 
'0036040646', 
'0036040846', 
'0036040890', 
'0036040892', 
'0036041292', 
'0036041426', 
'0036041428', 
'0036041430', 
'0036041432', 
'0036041434', 
'0036041436', 
'0036041556', 
'0036041744', 
'0036041746', 
'0036041756', 
'0036041758', 
'0036041760', 
'0036041762', 
'0036041766', 
'0036041768', 
'0036041874', 
'0036041876', 
'0036041976', 
'0036042036', 
'0036042054', 
'0036042056', 
'0036042310', 
'0036042320', 
'0036042322', 
'0036042324', 
'0036042326', 
'0036042328', 
'0036042330', 
'0036042738', 
'0036042740', 
'0036042742', 
'0036043006', 
'0036043008', 
'0036043230', 
'0036043522', 
'0036043524', 
'0036043526', 
'0036043528', 
'0036043632', 
'0036043724', 
'0036043864', 
'0036043968', 
'0036044020', 
'0036044194', 
'0036044258', 
'0036044284', 
'0036044466', 
'0036044496', 
'0036044700', 
'0036044702', 
'0036044704', 
'0036044916', 
'0036045264', 
'0036045328', 
'0036045332', 
'0036067359', 
'0036045464', 
'0036045596', 
'0036045612', 
'0036045618', 
'0036045628', 
'0036046242', 
'0036046550', 
'0036046602', 
'0036046608', 
'0036046896', 
'0036046898', 
'0036046900', 
'0036047006', 
'0036047052', 
'0036047114', 
'0036067583', 
'0036048258', 
'0036050312', 
'0036050314', 
'0036050316', 
'0036050318', 
'0036051650', 
'0036052420', 
'0036052734', 
'0036052736', 
'0036052738', 
'0036052740', 
'0036052742', 
'0036053130', 
'0036053132', 
'0036054848', 
'0036067564', 
'0036055098', 
'0036055114', 
'0036055348', 
'0036055350', 
'0036055352', 
'0036055354', 
'0036055356', 
'0036055368', 
'0036055372', 
'0036055378', 
'0036055382', 
'0036055398', 
'0036055512', 
'0036055578', 
'0036055602', 
'0036055608', 
'0036055616', 
'0036055642', 
'0036055688', 
'0036055694', 
'0036055696', 
'0036067521', 
'0036067526', 
'0036067532', 
'0036067516', 
'0036067552', 
'0036067557', 
'0036067569', 
'0036067600', 
'0036060934', 
'0036067561', 
'0036067536', 
'0036061250', 
'0035984422', 
'0036022328', 
'0036022392', 
'0036039176', 
'0036039178', 
'0036039180', 
'0036039182', 
'0036039184', 
'0036039186', 
'0036039188', 
'0036039190', 
'0036067473' 
)
                     
                     + DAY(CURRENT_DATE)
       AND E§DFNV >= YEAR(CURRENT_DATE) * 10000
                     + MONTH(CURRENT_DATE) * 100
                     + DAY(CURRENT_DATE)    
GROUP BY E§CRAG  HAVING COUNT(E§CRAG)  >1


AND E§TRAG <'999998'

AND substr(e§crag, 1, 7) >'2000000'

SELECT * FROM SMEDATBND.C£ESO00F WHERE P£TPRC='PVE' 
AND P£TP01='CNPVE' AND P£CD01 IN (SELECT E§SCEN FROM CED.BRENTIWK) 

INSERT INTO CED.C£CONR0PVE 
SELECT *
--DISTINCT C£CD01
FROM SMEDATBND.C£CONR0F WHERE C£TPRC='PVE' AND C£CD01 IN (SELECT E§SCEN FROM CED.BRENTIWK) 


 INSERT INTO CED.C£ESO00F 
SELECT * FROM SMEDATBND.C£ESO00F WHERE P£TPRC='PVE' 
AND P£TP01='CNPVE' AND P£CD01 IN (SELECT E§SCEN FROM CED.BRENTIWK) 


UPDATE SMEDATBND.C£CONR0F A
SET A.C£CD01=(SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.C£CD01) 
WHERE A.C£TPRC='PVE' AND A.C£CD01 IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )

UPDATE SMEDATBND.C£ESO00F A
SET A.P£CD01=(SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.P£CD01) 
WHERE A.P£TPRC='PVE' AND A.P£TP01='CNPVE' AND A.P£CD01 IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )


T§CDCL     Ente intestatario     
T§CDCC     Ente di conferma 
T§CODS     Ente di spedizione 

R§TCDS     Tipo ente di spedizione 
R§CODS     Ente di spedizione      
R§TCCL     Tipo ente intestatario  
R§CDCL     Ente Intestatario       


INSERT INTO EDP01.V5TDOC0F SELECT * FROM SMEDATBND.V5TDOC0F 
WHERE T§CDCL=T§CDCC AND  T§CDCL=T§CODS
AND T§CDCL IN (SELECT E§SCEN FROM EDP01.BRENTIWK) 

SELECT * FROM EDP01.V5TDOC0F 

INSERT INTO EDP01.V5RDOC0F SELECT * FROM SMEDATBND.V5RDOC0F 
WHERE R§CODS=R§CDCL -- AND  T§CDCL=T§CODS
AND R§CDCL IN (SELECT E§SCEN FROM EDP01.BRENTIWK) 

SELECT * FROM EDP01.V5RDOC0F 


UPDATE SMEDATBND.V5RDOC0F A 
SET A.R§CODS=( SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.R§CODS) 
WHERE A.R§TCDS='PVE' AND A.R§CODS IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )

UPDATE SMEDATBND.V5RDOC0F A 
SET A.R§CDCL=(SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.R§CDCL ) 
WHERE A.R§TCCL='PVE' AND A.R§CDCL IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )


UPDATE SMEDATBND.V5TDOC0F A 
SET A.T§CODS=( SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.T§CODS) 
WHERE A.T§TCDS='PVE' AND A.T§CODS IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )


UPDATE SMEDATBND.V5TDOC0F A 
SET A.T§CDCL=( SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.T§CDCL) 
WHERE A.T§TCCL='PVE' AND A.T§CDCL IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )


UPDATE SMEDATBND.V5TDOC0F A 
SET A.T§CDCC=( SELECT B.E§CRAG FROM EDP01.BRENTIWK B WHERE B.E§SCEN=A.T§CDCC) 
WHERE A.T§TCDC='PVE' AND A.T§CDCC IN 
(SELECT X.E§SCEN FROM EDP01.BRENTIWK X )




T§CDCL     Ente intestatario     
T§CDCC     Ente di conferma 
T§CODS  
