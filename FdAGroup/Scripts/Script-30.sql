
--(SELECT E$COD2,TTDESC,E$ALIA FROM CÂ£ALIA0F INNER JOIN TABELG0F ON     E$COD2 = TTELEM WHERE E$COD1 = 'TAC5B' AND TTSETT = 'C5B'


SELECT
T5AZIE || '|' ||  -- GL_BUSINESS_UNIT_CODE, 
R5CONT || '|' ||  -- GL_ACCOUNT_NUMBER, 
R5PROG || '|' ||  -- GL_JOURNAL_ID,
R5DTIN || '|' ||  -- GL_ENTRY_DATE , 
R5ORIN || '|' ||  -- GL_ENTRY_TIME,
T5DREG || '|' ||  -- GL_EFFECTIVE_DATE,
R5ESER || '|' ||  -- GL_FISCAL_YEAR,
(CASE WHEN (T5FL20<>'' OR R5FL18<>'') THEN '1' ELSE ' ' END) || '|' ||  -- GL_MANUAL_INDICATOR,
R5DAAV || '|' ||  -- GL_AMOUNT_CR_DR_INDICATOR,
(CASE WHEN R5VALU='' THEN 'EUR' ELSE R5VALU END) || '|' ||  -- GL_REPORTING_AMOUNT_CURRENCY,
R5IMVA || '|' ||  -- GL_REPORTING_AMOUNT,
TTDESC || '|' ||  
T5DDOR || '|' ||  
T5USIN   
--FROM SMEDATFDA.C5TREG0F INNER JOIN SMEDATFDA.C5RREG0F ON R5PROG=T5PROG INNER JOIN SMEDATGRU5.TABELG0F  -- FDA
--FROM SMEDATLIZ.C5TREG0F INNER JOIN SMEDATLIZ.C5RREG0F ON R5PROG=T5PROG INNER JOIN SMEDATGRU5.TABELG0F  -- LIZZI                  
FROM SMEDATBND.C5TREG0F INNER JOIN SMEDATBND.C5RREG0F ON R5PROG=T5PROG INNER JOIN SMEDATGRU5.TABELG0F  -- SIPA                  
ON TTSETT='C5B' AND TTELEM=R5CONT WHERE T5AZIE IN 
-- ('03', '04', '05', '08') 
--('01', '02', '06', '07', '11') -- FDA
--('09')  -- LIZZI 
('10')  -- SIPA                   
--AND T5DREG BETWEEN 20220101 AND 20220331   -- primo   trim 
--AND T5DREG BETWEEN 20220401 AND 20220630   -- secondo trim
--AND T5DREG BETWEEN 20220701 AND 20220930   -- terzo   trim
--AND T5DREG BETWEEN 20221001 AND 20221231   -- quarto trim
--AND T5DREG BETWEEN 20220101 AND 20221231   -- Anno intero 
AND R5ESER=2022
AND T5FL01<='2' AND T5FL02='6' AND R5FL19='1'                                  
AND T5TPRO<>'**' AND (R5IMPO<>0 OR R5IMVA<>0) 
